# é¡¹ç›®ç»“æ„è®¾è®¡

## ğŸ“‹ æœ¬æ–‡æ¡£å†…å®¹

- Cocos Creator é¡¹ç›®ç›®å½•ç»„ç»‡
- åœºæ™¯å’Œé¢„åˆ¶ä½“è®¾è®¡
- è„šæœ¬æ¨¡å—åˆ’åˆ†
- èµ„æºåˆ†ç±»ç®¡ç†

---

## 1ï¸âƒ£ å®Œæ•´ç›®å½•ç»“æ„

```
proj-cocos/
â”œâ”€â”€ assets/                          # èµ„æºç›®å½•ï¼ˆæ ¸å¿ƒå¼€å‘åŒºåŸŸï¼‰
â”‚   â”‚
â”‚   â”œâ”€â”€ scenes/                      # åœºæ™¯æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ Game.scene              # ä¸»æ¸¸æˆåœºæ™¯
â”‚   â”‚   â”œâ”€â”€ Settings.scene          # è®¾ç½®åœºæ™¯
â”‚   â”‚   â””â”€â”€ Test.scene              # æµ‹è¯•åœºæ™¯
â”‚   â”‚
â”‚   â”œâ”€â”€ scripts/                     # TypeScript è„šæœ¬
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ core/                   # æ ¸å¿ƒæ¸¸æˆé€»è¾‘
â”‚   â”‚   â”‚   â”œâ”€â”€ GameManager.ts     # æ¸¸æˆä¸»æ§åˆ¶å™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ WordManager.ts     # å•è¯ç®¡ç†å™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ ScoreManager.ts    # åˆ†æ•°å’Œç­‰çº§ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ InputManager.ts    # è¾“å…¥å¤„ç†
â”‚   â”‚   â”‚   â””â”€â”€ BufferManager.ts   # ç¼“å†²åŒºç®¡ç†
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ systems/                # æ¸¸æˆç³»ç»Ÿ
â”‚   â”‚   â”‚   â”œâ”€â”€ CannonSystem.ts    # ç‚®ç®¡ç³»ç»Ÿ
â”‚   â”‚   â”‚   â”œâ”€â”€ ExplosionSystem.ts # çˆ†ç‚¸ç³»ç»Ÿ
â”‚   â”‚   â”‚   â”œâ”€â”€ ParticleSystem.ts  # ç²’å­ç³»ç»Ÿ
â”‚   â”‚   â”‚   â””â”€â”€ CollisionSystem.ts # ç¢°æ’æ£€æµ‹
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ entities/               # æ¸¸æˆå®ä½“
â”‚   â”‚   â”‚   â”œâ”€â”€ WordEntity.ts      # å•è¯å®ä½“
â”‚   â”‚   â”‚   â”œâ”€â”€ CannonEntity.ts    # ç‚®ç®¡å®ä½“
â”‚   â”‚   â”‚   â”œâ”€â”€ BulletEntity.ts    # ç‚®å¼¹å®ä½“
â”‚   â”‚   â”‚   â””â”€â”€ FuseEntity.ts      # å¼•ä¿¡å®ä½“
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ui/                     # UI ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ GameUI.ts          # æ¸¸æˆä¸»ç•Œé¢
â”‚   â”‚   â”‚   â”œâ”€â”€ SettingsUI.ts      # è®¾ç½®ç•Œé¢
â”‚   â”‚   â”‚   â”œâ”€â”€ VocabularyUI.ts    # ç”Ÿè¯æœ¬ç•Œé¢
â”‚   â”‚   â”‚   â”œâ”€â”€ ImageShowcase.ts   # å›¾ç‰‡å±•ç¤ºåŒº
â”‚   â”‚   â”‚   â””â”€â”€ DebugPanel.ts      # è°ƒè¯•é¢æ¿
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ utils/                  # å·¥å…·ç±»
â”‚   â”‚   â”‚   â”œâ”€â”€ TTSService.ts      # TTS è¯­éŸ³æœåŠ¡
â”‚   â”‚   â”‚   â”œâ”€â”€ AudioCache.ts      # éŸ³é¢‘ç¼“å­˜
â”‚   â”‚   â”‚   â”œâ”€â”€ MissedWordsManager.ts # ç”Ÿè¯ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ PhoneticFormatter.ts  # éŸ³æ ‡æ ¼å¼åŒ–
â”‚   â”‚   â”‚   â””â”€â”€ DebugLogger.ts     # è°ƒè¯•æ—¥å¿—
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ config/                 # é…ç½®æ–‡ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ GameConfig.ts      # æ¸¸æˆé…ç½®
â”‚   â”‚   â”‚   â”œâ”€â”€ LevelConfig.ts     # å…³å¡é…ç½®
â”‚   â”‚   â”‚   â””â”€â”€ R2Config.ts        # R2 é…ç½®
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ types/                  # TypeScript ç±»å‹å®šä¹‰
â”‚   â”‚       â”œâ”€â”€ Word.ts            # å•è¯ç±»å‹
â”‚   â”‚       â”œâ”€â”€ GameState.ts       # æ¸¸æˆçŠ¶æ€ç±»å‹
â”‚   â”‚       â””â”€â”€ Config.ts          # é…ç½®ç±»å‹
â”‚   â”‚
â”‚   â”œâ”€â”€ prefabs/                     # é¢„åˆ¶ä½“
â”‚   â”‚   â”œâ”€â”€ entities/               # å®ä½“é¢„åˆ¶ä½“
â”‚   â”‚   â”‚   â”œâ”€â”€ Word.prefab        # å•è¯é¢„åˆ¶ä½“
â”‚   â”‚   â”‚   â”œâ”€â”€ Cannon.prefab      # ç‚®ç®¡é¢„åˆ¶ä½“
â”‚   â”‚   â”‚   â”œâ”€â”€ Bullet.prefab      # ç‚®å¼¹é¢„åˆ¶ä½“
â”‚   â”‚   â”‚   â””â”€â”€ Explosion.prefab   # çˆ†ç‚¸é¢„åˆ¶ä½“
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ui/                     # UI é¢„åˆ¶ä½“
â”‚   â”‚   â”‚   â”œâ”€â”€ TopBar.prefab      # é¡¶éƒ¨ä¿¡æ¯æ 
â”‚   â”‚   â”‚   â”œâ”€â”€ Sidebar.prefab     # ä¾§è¾¹æ 
â”‚   â”‚   â”‚   â”œâ”€â”€ ControlPanel.prefab # æ§åˆ¶é¢æ¿
â”‚   â”‚   â”‚   â””â”€â”€ Modal.prefab       # å¼¹çª—
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ effects/                # æ•ˆæœé¢„åˆ¶ä½“
â”‚   â”‚       â”œâ”€â”€ Particle.prefab    # ç²’å­æ•ˆæœ
â”‚   â”‚       â”œâ”€â”€ RedCross.prefab    # çº¢å‰æ ‡è®°
â”‚   â”‚       â””â”€â”€ Highlight.prefab   # é«˜äº®æ•ˆæœ
â”‚   â”‚
â”‚   â”œâ”€â”€ resources/                   # åŠ¨æ€åŠ è½½èµ„æº
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ words/                  # å•è¯åº“
â”‚   â”‚   â”‚   â”œâ”€â”€ config-v2.json     # è¯åº“é…ç½®
â”‚   â”‚   â”‚   â”œâ”€â”€ daily-phonics/     # æŒ‰å¤©å­¦ä¹ 
â”‚   â”‚   â”‚   â”œâ”€â”€ special-practice/  # ä¸“é¡¹ç»ƒä¹ 
â”‚   â”‚   â”‚   â””â”€â”€ grade-based/       # æŒ‰å¹´çº§
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ audio/                  # éŸ³é¢‘æ–‡ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ tts/               # TTS ç¼“å­˜
â”‚   â”‚   â”‚   â”œâ”€â”€ bgm/               # èƒŒæ™¯éŸ³ä¹
â”‚   â”‚   â”‚   â””â”€â”€ sfx/               # éŸ³æ•ˆ
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ images/                 # å›¾ç‰‡èµ„æº
â”‚   â”‚   â”‚   â”œâ”€â”€ words/             # å•è¯å›¾ç‰‡
â”‚   â”‚   â”‚   â”œâ”€â”€ ui/                # UI å›¾ç‰‡
â”‚   â”‚   â”‚   â””â”€â”€ icons/             # å›¾æ ‡
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ fonts/                  # å­—ä½“æ–‡ä»¶
â”‚   â”‚       â””â”€â”€ custom.ttf
â”‚   â”‚
â”‚   â”œâ”€â”€ textures/                    # çº¹ç†èµ„æºï¼ˆç¼–è¾‘å™¨å¼•ç”¨ï¼‰
â”‚   â”‚   â”œâ”€â”€ ui/                     # UI çº¹ç†
â”‚   â”‚   â”œâ”€â”€ sprites/                # ç²¾çµå›¾
â”‚   â”‚   â””â”€â”€ particles/              # ç²’å­çº¹ç†
â”‚   â”‚
â”‚   â””â”€â”€ animations/                  # åŠ¨ç”»èµ„æº
â”‚       â”œâ”€â”€ cannon/                 # ç‚®ç®¡åŠ¨ç”»
â”‚       â”œâ”€â”€ word/                   # å•è¯åŠ¨ç”»
â”‚       â””â”€â”€ ui/                     # UI åŠ¨ç”»
â”‚
â”œâ”€â”€ build/                           # æ„å»ºè¾“å‡ºï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼Œä¸æäº¤ï¼‰
â”œâ”€â”€ library/                         # ç¼–è¯‘ç¼“å­˜ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼Œä¸æäº¤ï¼‰
â”œâ”€â”€ temp/                            # ä¸´æ—¶æ–‡ä»¶ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼Œä¸æäº¤ï¼‰
â”œâ”€â”€ local/                           # æœ¬åœ°é…ç½®ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼Œä¸æäº¤ï¼‰
â”œâ”€â”€ settings/                        # é¡¹ç›®è®¾ç½®
â”œâ”€â”€ extensions/                      # æ‰©å±•æ’ä»¶
â”œâ”€â”€ docs/                            # æ–‡æ¡£ç›®å½•
â”‚   â”œâ”€â”€ 01_è¿ç§»æ€»è§ˆ.md
â”‚   â”œâ”€â”€ 02_ç¯å¢ƒå‡†å¤‡.md
â”‚   â”œâ”€â”€ 03_é¡¹ç›®ç»“æ„è®¾è®¡.md
â”‚   â””â”€â”€ ...
â”œâ”€â”€ package.json                     # npm ä¾èµ–é…ç½®
â”œâ”€â”€ tsconfig.json                    # TypeScript é…ç½®
â”œâ”€â”€ project.json                     # Cocos é¡¹ç›®é…ç½®
â”œâ”€â”€ .gitignore                       # Git å¿½ç•¥é…ç½®
â””â”€â”€ README.md                        # é¡¹ç›®è¯´æ˜
```

---

## 2ï¸âƒ£ åœºæ™¯è®¾è®¡

### 2.1 ä¸»æ¸¸æˆåœºæ™¯ï¼ˆGame.sceneï¼‰

**èŠ‚ç‚¹å±‚çº§ç»“æ„ï¼š**

```
Canvas (æ ¹èŠ‚ç‚¹)
â”‚
â”œâ”€â”€ Camera (ç›¸æœº)
â”‚
â”œâ”€â”€ GameLayer (æ¸¸æˆå±‚ - z-index: 0)
â”‚   â”‚
â”‚   â”œâ”€â”€ Background (èƒŒæ™¯)
â”‚   â”‚   â””â”€â”€ Sprite (æ·±è“è‰²æ¸å˜)
â”‚   â”‚
â”‚   â”œâ”€â”€ BufferZone (ç¼“å†²åŒº)
â”‚   â”‚   â”œâ”€â”€ TrafficLights (ä¿¡å·ç¯å®¹å™¨)
â”‚   â”‚   â”‚   â”œâ”€â”€ RedLight (çº¢ç¯)
â”‚   â”‚   â”‚   â”œâ”€â”€ YellowLight (é»„ç¯)
â”‚   â”‚   â”‚   â””â”€â”€ GreenLight (ç»¿ç¯)
â”‚   â”‚   â””â”€â”€ NextWordLabel (ä¸‹ä¸€ä¸ªå•è¯æ˜¾ç¤º)
â”‚   â”‚
â”‚   â”œâ”€â”€ GameZone (æ¸¸æˆåŒºåŸŸ)
â”‚   â”‚   â”œâ”€â”€ WordsContainer (å•è¯å®¹å™¨)
â”‚   â”‚   â”‚   â””â”€â”€ [åŠ¨æ€åˆ›å»ºçš„ Word èŠ‚ç‚¹]
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ StackZone (å †å åŒº)
â”‚   â”‚   â”‚   â””â”€â”€ [å †å çš„å•è¯]
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ Cannon (ç‚®ç®¡)
â”‚   â”‚       â”œâ”€â”€ Base (ç‚®å°åŸºåº§ - ä¸æ—‹è½¬)
â”‚   â”‚       â”œâ”€â”€ Platform (ç‚®å°å¹³å° - æ—‹è½¬)
â”‚   â”‚       â”œâ”€â”€ Barrel (ç‚®ç®¡ä¸»ä½“ - æ—‹è½¬)
â”‚   â”‚       â”‚   â”œâ”€â”€ BarrelBack (åæ®µ)
â”‚   â”‚       â”‚   â”œâ”€â”€ BarrelMiddle (ä¸­æ®µ)
â”‚   â”‚       â”‚   â”œâ”€â”€ BarrelFront (å‰æ®µ)
â”‚   â”‚       â”‚   â””â”€â”€ Muzzle (ç‚®å£)
â”‚   â”‚       â””â”€â”€ Fuse (å¼•ä¿¡ - ç‰©ç†æ‘†åŠ¨)
â”‚   â”‚           â””â”€â”€ FuseParticles (ç«ç„°ç²’å­)
â”‚   â”‚
â”‚   â”œâ”€â”€ EffectsLayer (æ•ˆæœå±‚ - z-index: 10)
â”‚   â”‚   â”œâ”€â”€ BulletsContainer (ç‚®å¼¹å®¹å™¨)
â”‚   â”‚   â”œâ”€â”€ ExplosionsContainer (çˆ†ç‚¸å®¹å™¨)
â”‚   â”‚   â””â”€â”€ ParticlesContainer (ç²’å­å®¹å™¨)
â”‚   â”‚
â”‚   â””â”€â”€ HighlightsLayer (é«˜äº®å±‚ - z-index: 20)
â”‚       â”œâ”€â”€ InputHighlight (è¾“å…¥é«˜äº®)
â”‚       â””â”€â”€ RedCrossMarks (çº¢å‰æ ‡è®°)
â”‚
â””â”€â”€ UILayer (UIå±‚ - z-index: 100)
    â”‚
    â”œâ”€â”€ LeftPanel (å·¦ä¾§é¢æ¿)
    â”‚   â”œâ”€â”€ ImageShowcase (å›¾ç‰‡å±•ç¤ºåŒº)
    â”‚   â”‚   â”œâ”€â”€ ImageFrame (å›¾ç‰‡æ¡†)
    â”‚   â”‚   â”œâ”€â”€ WordLabel (å•è¯æ ‡ç­¾)
    â”‚   â”‚   â”œâ”€â”€ PhoneticLabel (éŸ³æ ‡æ ‡ç­¾)
    â”‚   â”‚   â””â”€â”€ MeaningLabel (ä¸­æ–‡é‡Šä¹‰)
    â”‚   â”‚
    â”‚   â””â”€â”€ ControlPanel (æ§åˆ¶é¢æ¿)
    â”‚       â”œâ”€â”€ InputBox (è¾“å…¥æ¡†)
    â”‚       â”œâ”€â”€ PreviewLabel (å®æ—¶é¢„è§ˆ)
    â”‚       â””â”€â”€ Buttons (æŒ‰é’®ç»„)
    â”‚
    â”œâ”€â”€ TopBar (é¡¶éƒ¨ä¿¡æ¯æ )
    â”‚   â”œâ”€â”€ ScoreLabel (åˆ†æ•°)
    â”‚   â”œâ”€â”€ LevelLabel (ç­‰çº§)
    â”‚   â”œâ”€â”€ TargetLabel (ç›®æ ‡)
    â”‚   â”œâ”€â”€ VocabCountLabel (å•è¯æ€»æ•°)
    â”‚   â”œâ”€â”€ TimeLabel (æ—¶é—´)
    â”‚   â””â”€â”€ ComboLabel (è¿å‡»)
    â”‚
    â”œâ”€â”€ ExamStats (è€ƒè¯•ç»Ÿè®¡æ )
    â”‚   â”œâ”€â”€ TotalWordsLabel (å‰©ä½™å¾…æµ‹)
    â”‚   â”œâ”€â”€ HitWordsLabel (æ­£ç¡®å‘½ä¸­)
    â”‚   â””â”€â”€ CoverageLabel (è¦†ç›–ç‡)
    â”‚
    â”œâ”€â”€ Sidebar (å³ä¾§è¾¹æ )
    â”‚   â”œâ”€â”€ BufferIndicator (ç¼“å†²åŒºæŒ‡ç¤º)
    â”‚   â”œâ”€â”€ VocabularyBook (ç”Ÿè¯æœ¬)
    â”‚   â”œâ”€â”€ Instructions (æ¸¸æˆè¯´æ˜)
    â”‚   â””â”€â”€ DebugPanel (è°ƒè¯•é¢æ¿)
    â”‚
    â””â”€â”€ Modals (å¼¹çª—å®¹å™¨)
        â”œâ”€â”€ GameOverModal (æ¸¸æˆç»“æŸ)
        â”œâ”€â”€ LevelUpModal (ç­‰çº§æå‡)
        â””â”€â”€ SettingsModal (è®¾ç½®)
```

### 2.2 è®¾ç½®åœºæ™¯ï¼ˆSettings.sceneï¼‰

**èŠ‚ç‚¹å±‚çº§ç»“æ„ï¼š**

```
Canvas
â”œâ”€â”€ Camera
â””â”€â”€ SettingsUI
    â”œâ”€â”€ Background
    â”œâ”€â”€ Title
    â”œâ”€â”€ GameModeSection (æ¸¸æˆæ¨¡å¼)
    â”œâ”€â”€ VocabularySection (è¯åº“é€‰æ‹©)
    â”œâ”€â”€ AudioSection (éŸ³é¢‘è®¾ç½®)
    â”œâ”€â”€ AdvancedSection (é«˜çº§è®¾ç½®)
    â””â”€â”€ Buttons (ä¿å­˜/å–æ¶ˆ)
```

---

## 3ï¸âƒ£ é¢„åˆ¶ä½“è®¾è®¡

### 3.1 Word é¢„åˆ¶ä½“ï¼ˆWord.prefabï¼‰

**ç»„ä»¶ç»“æ„ï¼š**
```
Word (Node)
â”œâ”€â”€ WordEntity (Script) - å•è¯é€»è¾‘è„šæœ¬
â”œâ”€â”€ Background (Sprite) - èƒŒæ™¯æ¡†
â”œâ”€â”€ LettersContainer (Node) - å­—æ¯å®¹å™¨
â”‚   â””â”€â”€ [åŠ¨æ€åˆ›å»ºçš„ Label èŠ‚ç‚¹] - æ¯ä¸ªå­—æ¯
â”œâ”€â”€ InputHighlight (Sprite) - è¾“å…¥é«˜äº®
â””â”€â”€ RedCross (Sprite) - é”™è¯¯æ ‡è®°
```

**WordEntity è„šæœ¬å±æ€§ï¼š**
```typescript
@property
wordData: WordData = null; // å•è¯æ•°æ®

@property(Node)
lettersContainer: Node = null;

@property(Prefab)
letterPrefab: Prefab = null;

@property(Sprite)
background: Sprite = null;

@property(Sprite)
highlight: Sprite = null;

@property(Sprite)
redCross: Sprite = null;
```

### 3.2 Cannon é¢„åˆ¶ä½“ï¼ˆCannon.prefabï¼‰

**ç»„ä»¶ç»“æ„ï¼š**
```
Cannon (Node)
â”œâ”€â”€ CannonEntity (Script) - ç‚®ç®¡é€»è¾‘
â”œâ”€â”€ Base (Sprite) - åŸºåº§ï¼ˆä¸æ—‹è½¬ï¼‰
â”œâ”€â”€ RotateGroup (Node) - æ—‹è½¬ç»„
â”‚   â”œâ”€â”€ Platform (Sprite) - å¹³å°
â”‚   â”œâ”€â”€ Barrel (Node) - ç‚®ç®¡ç»„
â”‚   â”‚   â”œâ”€â”€ BarrelBack (Sprite)
â”‚   â”‚   â”œâ”€â”€ BarrelMiddle (Sprite)
â”‚   â”‚   â”œâ”€â”€ BarrelFront (Sprite)
â”‚   â”‚   â””â”€â”€ Muzzle (Sprite)
â”‚   â””â”€â”€ Fuse (Node) - å¼•ä¿¡
â”‚       â”œâ”€â”€ FuseEntity (Script) - ç‰©ç†æ‘†åŠ¨é€»è¾‘
â”‚       â”œâ”€â”€ FuseLine (Graphics) - å¼•ä¿¡ç»³å­
â”‚       â”œâ”€â”€ FuseGlow (Sprite) - å‘å…‰æ•ˆæœ
â”‚       â””â”€â”€ FuseParticles (ParticleSystem2D) - ç«ç„°ç²’å­
```

### 3.3 Bullet é¢„åˆ¶ä½“ï¼ˆBullet.prefabï¼‰

**ç»„ä»¶ç»“æ„ï¼š**
```
Bullet (Node)
â”œâ”€â”€ BulletEntity (Script) - ç‚®å¼¹é€»è¾‘
â”œâ”€â”€ OuterGlow (Sprite) - å¤–å±‚å…‰æ™•ï¼ˆçº¢è‰²ï¼‰
â”œâ”€â”€ MiddleFire (Sprite) - ä¸­å±‚ç«çƒï¼ˆæ©™è‰²ï¼‰
â”œâ”€â”€ InnerCore (Sprite) - å†…æ ¸ï¼ˆäº®é»„è‰²ï¼‰
â”œâ”€â”€ FlameParticles (ParticleSystem2D) - ç«ç„°çº¹ç†
â””â”€â”€ Trail (MotionStreak) - ç«ç„°å°¾è¿¹
```

### 3.4 Explosion é¢„åˆ¶ä½“ï¼ˆExplosion.prefabï¼‰

**ç»„ä»¶ç»“æ„ï¼š**
```
Explosion (Node)
â”œâ”€â”€ ExplosionEntity (Script) - çˆ†ç‚¸é€»è¾‘
â”œâ”€â”€ Particles (ParticleSystem2D) - å¤šå½©ç²’å­
â”œâ”€â”€ MeaningLabel (Label) - ä¸­æ–‡ç¿»è¯‘
â””â”€â”€ Flash (Sprite) - é—ªå…‰æ•ˆæœ
```

---

## 4ï¸âƒ£ è„šæœ¬æ¨¡å—è®¾è®¡

### 4.1 æ ¸å¿ƒæ¨¡å—ï¼ˆcore/ï¼‰

#### GameManager.tsï¼ˆæ¸¸æˆä¸»æ§åˆ¶å™¨ï¼‰

```typescript
import { _decorator, Component, Node } from 'cc';
const { ccclass, property } = _decorator;

/**
 * æ¸¸æˆä¸»æ§åˆ¶å™¨
 * è´Ÿè´£æ¸¸æˆæµç¨‹æ§åˆ¶ã€çŠ¶æ€ç®¡ç†ã€æ¨¡å—åè°ƒ
 */
@ccclass('GameManager')
export class GameManager extends Component {
    // å¼•ç”¨å…¶ä»–ç®¡ç†å™¨
    @property(WordManager)
    wordManager: WordManager = null;
    
    @property(ScoreManager)
    scoreManager: ScoreManager = null;
    
    @property(InputManager)
    inputManager: InputManager = null;
    
    @property(BufferManager)
    bufferManager: BufferManager = null;
    
    // æ¸¸æˆçŠ¶æ€
    private gameState: GameState = GameState.Ready;
    private isPaused: boolean = false;
    
    // æ ¸å¿ƒæ–¹æ³•
    public startGame(): void { /* ... */ }
    public pauseGame(): void { /* ... */ }
    public resumeGame(): void { /* ... */ }
    public resetGame(): void { /* ... */ }
    public levelUp(): void { /* ... */ }
    public gameOver(): void { /* ... */ }
    
    // ç”Ÿå‘½å‘¨æœŸ
    protected onLoad(): void { /* ... */ }
    protected start(): void { /* ... */ }
    protected update(dt: number): void { /* ... */ }
}
```

#### WordManager.tsï¼ˆå•è¯ç®¡ç†å™¨ï¼‰

```typescript
/**
 * å•è¯ç®¡ç†å™¨
 * è´Ÿè´£å•è¯åº“åŠ è½½ã€å•è¯ç”Ÿæˆã€å•è¯ç§»åŠ¨ã€ç¢°æ’æ£€æµ‹
 */
@ccclass('WordManager')
export class WordManager extends Component {
    @property(Prefab)
    wordPrefab: Prefab = null;
    
    @property(Node)
    wordsContainer: Node = null;
    
    // å•è¯æ•°æ®
    private allWords: WordData[] = [];
    private currentWord: WordEntity = null;
    private stackedWords: WordEntity[] = [];
    
    // æ ¸å¿ƒæ–¹æ³•
    public async loadVocabulary(): Promise<void> { /* ... */ }
    public releaseWord(): void { /* ... */ }
    public removeWord(word: WordEntity): void { /* ... */ }
    public stackWord(word: WordEntity): void { /* ... */ }
    public checkCollision(bullet: BulletEntity): WordEntity { /* ... */ }
}
```

### 4.2 ç³»ç»Ÿæ¨¡å—ï¼ˆsystems/ï¼‰

#### CannonSystem.tsï¼ˆç‚®ç®¡ç³»ç»Ÿï¼‰

```typescript
/**
 * ç‚®ç®¡ç³»ç»Ÿ
 * è´Ÿè´£ç‚®ç®¡æ¸²æŸ“ã€ç„å‡†ã€å°„å‡»ã€åååŠ›
 */
@ccclass('CannonSystem')
export class CannonSystem extends Component {
    @property(Node)
    cannon: Node = null;
    
    @property(Node)
    rotateGroup: Node = null;
    
    @property(Prefab)
    bulletPrefab: Prefab = null;
    
    // ç‚®ç®¡çŠ¶æ€
    private targetAngle: number = 0;
    private currentAngle: number = 0;
    private recoil: number = 0;
    
    // æ ¸å¿ƒæ–¹æ³•
    public aimAt(target: Vec3): void { /* ... */ }
    public fire(): BulletEntity { /* ... */ }
    public updateRecoil(dt: number): void { /* ... */ }
}
```

#### ExplosionSystem.tsï¼ˆçˆ†ç‚¸ç³»ç»Ÿï¼‰

```typescript
/**
 * çˆ†ç‚¸ç³»ç»Ÿ
 * è´Ÿè´£ç²’å­çˆ†ç‚¸ã€ä¸­æ–‡ç¿»è¯‘åŠ¨ç”»
 */
@ccclass('ExplosionSystem')
export class ExplosionSystem extends Component {
    @property(Prefab)
    explosionPrefab: Prefab = null;
    
    @property(Node)
    explosionsContainer: Node = null;
    
    // æ ¸å¿ƒæ–¹æ³•
    public createExplosion(position: Vec3, meaning: string): void { /* ... */ }
    private createParticles(position: Vec3): void { /* ... */ }
    private createMeaningAnimation(position: Vec3, meaning: string): void { /* ... */ }
}
```

### 4.3 å®ä½“æ¨¡å—ï¼ˆentities/ï¼‰

#### WordEntity.tsï¼ˆå•è¯å®ä½“ï¼‰

```typescript
/**
 * å•è¯å®ä½“
 * å•ä¸ªå•è¯çš„æ˜¾ç¤ºå’Œäº¤äº’é€»è¾‘
 */
@ccclass('WordEntity')
export class WordEntity extends Component {
    // å•è¯æ•°æ®
    private wordData: WordData = null;
    private inputText: string = '';
    private isCorrect: boolean = false;
    
    // è§†è§‰ç»„ä»¶
    @property(Node)
    lettersContainer: Node = null;
    
    // æ ¸å¿ƒæ–¹æ³•
    public init(data: WordData): void { /* ... */ }
    public updateInput(input: string): void { /* ... */ }
    public showRedCross(index: number): void { /* ... */ }
    public highlightCorrect(): void { /* ... */ }
    public fall(dt: number): void { /* ... */ }
}
```

---

## 5ï¸âƒ£ èµ„æºç®¡ç†è§„èŒƒ

### 5.1 å‘½åè§„èŒƒ

**æ–‡ä»¶å‘½åï¼š**
- è„šæœ¬æ–‡ä»¶ï¼šPascalCaseï¼ˆå¦‚ `GameManager.ts`ï¼‰
- åœºæ™¯æ–‡ä»¶ï¼šPascalCaseï¼ˆå¦‚ `Game.scene`ï¼‰
- é¢„åˆ¶ä½“æ–‡ä»¶ï¼šPascalCaseï¼ˆå¦‚ `Word.prefab`ï¼‰
- èµ„æºæ–‡ä»¶ï¼škebab-caseï¼ˆå¦‚ `word-background.png`ï¼‰
- JSON æ–‡ä»¶ï¼škebab-caseï¼ˆå¦‚ `config-v2.json`ï¼‰

**èŠ‚ç‚¹å‘½åï¼š**
- å®¹å™¨èŠ‚ç‚¹ï¼šä½¿ç”¨ `Container` åç¼€ï¼ˆå¦‚ `WordsContainer`ï¼‰
- UI èŠ‚ç‚¹ï¼šä½¿ç”¨ `UI` åç¼€ï¼ˆå¦‚ `GameUI`ï¼‰
- ç»„èŠ‚ç‚¹ï¼šä½¿ç”¨ `Group` åç¼€ï¼ˆå¦‚ `RotateGroup`ï¼‰

### 5.2 èµ„æºå¼•ç”¨æ–¹å¼

**ç¼–è¾‘å™¨å¼•ç”¨ï¼ˆprefabs/ï¼‰ï¼š**
```typescript
@property(Prefab)
wordPrefab: Prefab = null; // åœ¨ç¼–è¾‘å™¨ä¸­æ‹–æ‹½èµ‹å€¼
```

**åŠ¨æ€åŠ è½½ï¼ˆresources/ï¼‰ï¼š**
```typescript
// åŠ è½½å•è¯åº“
cc.resources.load('words/day01', JsonAsset, (err, asset) => {
    if (!err) {
        const words = asset.json;
    }
});

// åŠ è½½éŸ³é¢‘
cc.resources.load('audio/tts/hello_baidu', AudioClip, (err, clip) => {
    if (!err) {
        cc.audioEngine.play(clip, false, 1.0);
    }
});

// åŠ è½½å›¾ç‰‡
cc.resources.load('images/words/hello', SpriteFrame, (err, frame) => {
    if (!err) {
        sprite.spriteFrame = frame;
    }
});
```

### 5.3 èµ„æºé‡Šæ”¾ç­–ç•¥

```typescript
// é‡Šæ”¾ä¸å†ä½¿ç”¨çš„èµ„æº
cc.resources.release('words/day01');

// é‡Šæ”¾åŠ¨æ€åˆ›å»ºçš„èŠ‚ç‚¹
node.destroy();

// å¯¹è±¡æ± ç®¡ç†ï¼ˆé‡è¦ï¼ï¼‰
private bulletPool: NodePool = new NodePool();

// è·å–ç‚®å¼¹ï¼ˆä»å¯¹è±¡æ± ï¼‰
getBullet(): Node {
    let bullet = this.bulletPool.get();
    if (!bullet) {
        bullet = cc.instantiate(this.bulletPrefab);
    }
    return bullet;
}

// å›æ”¶ç‚®å¼¹
recycleBullet(bullet: Node): void {
    this.bulletPool.put(bullet);
}
```

---

## 6ï¸âƒ£ ç±»å‹å®šä¹‰ï¼ˆtypes/ï¼‰

### Word.ts

```typescript
/**
 * å•è¯æ•°æ®æ¥å£
 */
export interface WordData {
    word: string;            // å•è¯
    phonetic: string;        // éŸ³æ ‡
    meaning: string;         // ä¸­æ–‡é‡Šä¹‰
    difficulty: number;      // éš¾åº¦ (1-3)
    missingCount: number;    // ç¼ºå¤±å­—æ¯æ•°é‡
    missingIndices: number[]; // ç¼ºå¤±ä½ç½®
    stressPositions: number[]; // é‡éŸ³ä½ç½®
}

/**
 * å•è¯åº“é…ç½®æ¥å£
 */
export interface VocabularyConfig {
    id: string;
    name: string;
    description: string;
    level: string;
    words: WordData[];
}
```

### GameState.ts

```typescript
/**
 * æ¸¸æˆçŠ¶æ€æšä¸¾
 */
export enum GameState {
    Ready = 'ready',
    Playing = 'playing',
    Paused = 'paused',
    LevelUp = 'levelup',
    GameOver = 'gameover'
}

/**
 * æ¸¸æˆç»Ÿè®¡æ•°æ®
 */
export interface GameStats {
    score: number;
    level: number;
    combo: number;
    totalWords: number;
    hitWords: number;
    missedWords: string[];
}
```

---

## 7ï¸âƒ£ é…ç½®æ–‡ä»¶ï¼ˆconfig/ï¼‰

### GameConfig.ts

```typescript
/**
 * æ¸¸æˆé…ç½®
 */
export class GameConfig {
    // æ¸¸æˆåŒºåŸŸå°ºå¯¸
    static readonly CANVAS_WIDTH = 600;
    static readonly CANVAS_HEIGHT = 500;
    
    // å•è¯ä¸‹é™é€Ÿåº¦
    static readonly BASE_FALL_SPEED = 0.2; // åƒç´ /å¸§
    static readonly SPEED_INCREMENT = 0.05; // æ¯çº§å¢åŠ 
    
    // åˆ†æ•°é…ç½®
    static readonly SCORE_PER_LETTER = 1;
    static readonly SHOOT_BONUS = 2;
    static readonly SPEED_BONUS_MULTIPLIER = 1.5;
    static readonly COMBO_BONUS = 1;
    
    // ç­‰çº§é…ç½®
    static readonly LEVEL_THRESHOLDS = [0, 100, 200, 300, 400, 500];
    
    // ç¼“å†²åŒºé…ç½®
    static readonly BUFFER_COUNTDOWN_TIME = 3000; // æ¯«ç§’
    static readonly LIGHT_DURATION = 1000; // æ¯ä¸ªç¯æŒç»­æ—¶é—´
}
```

---

## 8ï¸âƒ£ åˆ›å»ºæ­¥éª¤

### æ­¥éª¤ 1ï¼šåˆ›å»ºåœºæ™¯

1. æ‰“å¼€ Cocos Creator
2. å³é”® `assets` â†’ æ–°å»º â†’ Scene
3. å‘½åä¸º `Game`
4. åŒå‡»æ‰“å¼€åœºæ™¯

### æ­¥éª¤ 2ï¼šæ­å»ºåŸºæœ¬èŠ‚ç‚¹

1. åœ¨ Canvas ä¸‹åˆ›å»º `GameLayer` èŠ‚ç‚¹
2. åœ¨ Canvas ä¸‹åˆ›å»º `UILayer` èŠ‚ç‚¹
3. è®¾ç½®å±‚çº§ï¼ˆz-indexï¼‰

### æ­¥éª¤ 3ï¼šåˆ›å»ºè„šæœ¬

1. å³é”® `assets/scripts` â†’ æ–°å»º â†’ TypeScript
2. æŒ‰ç…§ä¸Šé¢çš„æ¨¡å—ç»“æ„åˆ›å»ºè„šæœ¬æ–‡ä»¶
3. ç¼–å†™åŸºç¡€ä»£ç æ¡†æ¶

### æ­¥éª¤ 4ï¼šåˆ›å»ºé¢„åˆ¶ä½“

1. åœ¨åœºæ™¯ä¸­æ­å»ºå¥½èŠ‚ç‚¹ç»“æ„
2. æ‹–æ‹½èŠ‚ç‚¹åˆ° `assets/prefabs/` ç›®å½•
3. åˆ é™¤åœºæ™¯ä¸­çš„èŠ‚ç‚¹

### æ­¥éª¤ 5ï¼šé…ç½®ç»„ä»¶

1. é€‰ä¸­èŠ‚ç‚¹
2. åœ¨å±æ€§æ£€æŸ¥å™¨ä¸­æ·»åŠ è„šæœ¬ç»„ä»¶
3. æ‹–æ‹½å¼•ç”¨å…³ç³»

---

## 9ï¸âƒ£ éªŒè¯æ¸…å•

- [ ] ç›®å½•ç»“æ„å·²åˆ›å»º
- [ ] åœºæ™¯æ–‡ä»¶å·²åˆ›å»º
- [ ] æ ¸å¿ƒè„šæœ¬æ¡†æ¶å·²æ­å»º
- [ ] é¢„åˆ¶ä½“å·²è®¾è®¡
- [ ] ç±»å‹å®šä¹‰å·²å®Œæˆ
- [ ] é…ç½®æ–‡ä»¶å·²åˆ›å»º
- [ ] èµ„æºç›®å½•å·²è§„åˆ’
- [ ] å‘½åè§„èŒƒå·²éµå®ˆ
- [ ] Git å¿½ç•¥é…ç½®å·²æ›´æ–°

---

**é¡¹ç›®ç»“æ„è®¾è®¡å®Œæˆï¼** âœ…

ä¸‹ä¸€æ­¥ï¼šé˜…è¯» [04_èµ„æºè¿ç§»æŒ‡å—.md](./04_èµ„æºè¿ç§»æŒ‡å—.md)

