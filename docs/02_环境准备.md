# 环境准备

## 📋 本文档内容

- Cocos Creator 版本选择和安装
- 项目创建和初始配置
- 开发工具配置
- 依赖安装

---

## 1️⃣ Cocos Creator 安装

### 推荐版本

**Cocos Creator 3.8.3**（或更高的 3.8.x 版本）

**为什么选择 3.8.x？**
- ✅ 最新稳定版本
- ✅ TypeScript 支持完善
- ✅ 性能优化更好
- ✅ Web 平台支持完善
- ✅ 2D 功能成熟

### 安装步骤

#### 方法一：使用 Cocos Dashboard（推荐）

1. **下载 Cocos Dashboard**
   - 访问：https://www.cocos.com/creator-download
   - 下载 Windows 版本安装包

2. **安装 Dashboard**
   - 双击安装文件
   - 默认路径：`C:\CocosDashboard`
   - 完成安装

3. **安装 Cocos Creator**
   - 打开 Cocos Dashboard
   - 登录/注册账号
   - 点击"编辑器"标签
   - 选择 3.8.3 版本
   - 点击"安装"
   - 安装路径建议：`C:\CocosCreator\3.8.3`

#### 方法二：直接下载安装包

1. 访问官网下载页面
2. 选择 3.8.3 版本直接下载
3. 运行安装程序
4. 按提示完成安装

### 验证安装

1. 打开 Cocos Creator
2. 查看版本号：左上角 "帮助" → "关于"
3. 应该显示：`Cocos Creator v3.8.3`

---

## 2️⃣ 项目创建（已完成）

✅ 你已经创建了空项目：`proj-cocos/`

### 检查项目配置

1. **打开项目**
   - 启动 Cocos Creator
   - 点击"打开其他项目"
   - 选择 `D:\workspace\WordPractice\proj-cocos`

2. **验证项目信息**
   - 项目名称：应该显示在编辑器顶部
   - 项目类型：2D 项目
   - 语言：建议选择 TypeScript

3. **基本目录结构**
   ```
   proj-cocos/
   ├── assets/              # 资源目录（核心）
   │   ├── scenes/         # 场景文件
   │   ├── scripts/        # 脚本代码
   │   └── resources/      # 动态加载资源
   ├── build/              # 构建输出（自动生成）
   ├── library/            # 编译缓存（自动生成）
   ├── temp/               # 临时文件（自动生成）
   ├── local/              # 本地配置（不提交 git）
   ├── settings/           # 项目设置
   ├── extensions/         # 扩展插件
   ├── docs/              # 文档目录（我们创建的）
   ├── package.json        # 项目依赖
   ├── tsconfig.json       # TypeScript 配置
   └── project.json        # 项目配置
   ```

---

## 3️⃣ 编辑器设置

### 推荐的编辑器配置

1. **偏好设置**（Cocos Creator 菜单 → 偏好设置）

   **通用**
   - 语言：中文（简体）
   - 自动保存：开启（间隔 5 分钟）
   
   **外部编辑器**
   - 选择 Visual Studio Code
   - 路径：`C:\Users\你的用户名\AppData\Local\Programs\Microsoft VS Code\Code.exe`
   
   **资源管理器**
   - 显示扩展名：开启
   - 显示隐藏文件：开启

2. **项目设置**（菜单 → 项目 → 项目设置）

   **功能剪裁**
   - 2D 物理：勾选（用于碰撞检测）
   - 粒子系统：勾选（用于爆炸效果）
   - UI：勾选（必需）
   
   **脚本**
   - 语言：TypeScript
   - 导入插件：全部勾选
   
   **引擎模块**
   - 2D：勾选全部
   - Audio：勾选（音频系统）
   - UI：勾选（必需）
   - Tween：勾选（动画系统）

---

## 4️⃣ Visual Studio Code 配置

### 安装 VS Code（如果没有）

1. 下载：https://code.visualstudio.com/
2. 安装并启动
3. 中文语言包：Ctrl+Shift+P → "Configure Display Language" → 安装中文

### 安装必要扩展

在 VS Code 扩展市场搜索并安装：

1. **Cocos Creator Extension**
   - 名称：Cocos Creator Extension
   - 功能：语法高亮、代码提示
   - 必装：⭐⭐⭐⭐⭐

2. **TypeScript 相关**
   - ESLint（代码检查）
   - Prettier（代码格式化）
   - TypeScript Importer（自动导入）

3. **辅助工具**
   - GitLens（Git 增强）
   - Error Lens（错误高亮）
   - TODO Highlight（待办高亮）

### VS Code 工作区配置

在项目根目录创建 `.vscode/settings.json`：

```json
{
  "typescript.tsdk": "node_modules/typescript/lib",
  "editor.formatOnSave": true,
  "editor.tabSize": 4,
  "files.associations": {
    "*.ts": "typescript"
  },
  "search.exclude": {
    "**/library": true,
    "**/temp": true,
    "**/build": true,
    "**/node_modules": true
  },
  "files.exclude": {
    "**/*.meta": true
  }
}
```

---

## 5️⃣ Git 配置

### .gitignore 设置

创建或更新 `proj-cocos/.gitignore`：

```gitignore
# Cocos Creator 自动生成的文件
/library/
/temp/
/local/
/build/

# 系统文件
.DS_Store
Thumbs.db

# 编辑器配置
.vscode/
.idea/

# 依赖
node_modules/

# 日志
*.log
npm-debug.log*

# 临时文件
*.tmp
*.temp
*.swp
*.swo

# 用户配置
settings/builder.json
```

### 应该提交的文件

```
✅ assets/          # 资源文件（必需）
✅ settings/        # 项目设置（部分）
✅ extensions/      # 扩展插件
✅ docs/           # 文档
✅ package.json    # 依赖配置
✅ tsconfig.json   # TypeScript 配置
✅ project.json    # 项目配置
✅ README.md       # 项目说明
```

---

## 6️⃣ Node.js 和依赖

### 检查 Node.js 版本

```bash
node -v
# 应该显示 v16.x 或更高版本
```

如果没有安装：
1. 下载：https://nodejs.org/
2. 安装 LTS 版本（推荐 v18.x 或 v20.x）

### 安装项目依赖

```bash
cd proj-cocos
npm install
```

### 可能需要的额外依赖

```bash
# 如果需要 TypeScript 类型定义
npm install --save-dev @types/node

# 如果需要代码检查
npm install --save-dev eslint typescript-eslint

# 如果需要 Prettier
npm install --save-dev prettier
```

---

## 7️⃣ 测试环境

### 创建测试场景

1. **在 Cocos Creator 中**
   - 右键 `assets` → 新建 → Scene
   - 命名：`TestScene`
   - 双击打开场景

2. **添加测试节点**
   - 在层级管理器中右键 Canvas
   - 创建 → 2D 对象 → Sprite
   - 在属性检查器中设置颜色为红色

3. **运行测试**
   - 点击编辑器顶部的"预览"按钮（▶️）
   - 浏览器应该打开并显示红色方块
   - 如果正常显示，说明环境配置成功 ✅

### 测试 TypeScript 编译

1. **创建测试脚本**
   - 右键 `assets` → 新建 → TypeScript
   - 命名：`TestScript`

2. **编写测试代码**
   ```typescript
   import { _decorator, Component, Node } from 'cc';
   const { ccclass, property } = _decorator;

   @ccclass('TestScript')
   export class TestScript extends Component {
       start() {
           console.log('✅ TypeScript 编译成功！');
           console.log('✅ Cocos Creator 环境正常！');
       }
   }
   ```

3. **挂载脚本**
   - 将脚本拖拽到 Canvas 节点上
   - 点击预览
   - 查看浏览器控制台，应该看到两条成功消息

---

## 8️⃣ 浏览器开发者工具

### 推荐使用 Chrome

1. **安装 Chrome**（如果没有）
   - 下载：https://www.google.com/chrome/

2. **设置默认浏览器**
   - Cocos Creator → 偏好设置 → 预览
   - 选择 Chrome

3. **开发者工具快捷键**
   - Windows：`F12` 或 `Ctrl+Shift+I`
   - Mac：`Cmd+Option+I`

4. **有用的功能**
   - Console：查看日志
   - Sources：调试代码（设置断点）
   - Network：查看资源加载
   - Performance：性能分析

---

## 9️⃣ 性能监控工具

### Cocos Creator 内置性能面板

1. **启用方法**
   - 菜单 → 项目 → 项目设置
   - 勾选"显示 FPS"
   - 勾选"显示性能统计"

2. **预览时查看**
   - 点击预览按钮
   - 游戏画面左上角会显示 FPS 和性能数据

### Chrome Performance Monitor

1. **打开方法**
   - Chrome 开发者工具
   - 三个点 → More tools → Performance monitor

2. **监控指标**
   - CPU usage
   - JS heap size
   - DOM Nodes
   - JS event listeners
   - Layouts / sec

---

## 🔟 环境验证清单

在开始迁移之前，确认以下所有项目：

- [ ] ✅ Cocos Creator 3.8.3 已安装
- [ ] ✅ 项目 `proj-cocos` 可以正常打开
- [ ] ✅ Visual Studio Code 已配置
- [ ] ✅ Node.js 版本符合要求（v16+）
- [ ] ✅ npm 依赖已安装
- [ ] ✅ Git 配置完成（.gitignore）
- [ ] ✅ 测试场景可以预览
- [ ] ✅ TypeScript 编译正常
- [ ] ✅ 浏览器开发者工具可用
- [ ] ✅ 性能监控工具已启用

**全部勾选后，环境准备完成！** 🎉

---

## 💡 常见问题

### Q1: Cocos Creator 启动很慢？
**A:** 正常现象，首次启动需要初始化。后续会快一些。可以添加到防火墙白名单。

### Q2: TypeScript 编译报错？
**A:** 检查 `tsconfig.json` 配置，确保 Cocos Creator 版本匹配。

### Q3: 预览时白屏？
**A:** 
1. 检查浏览器控制台错误
2. 确认场景中有 Canvas 节点
3. 尝试清理缓存（菜单 → 开发者 → 清除缓存）

### Q4: VS Code 没有代码提示？
**A:**
1. 确认安装了 Cocos Creator Extension
2. 重新加载窗口：Ctrl+Shift+P → "Reload Window"
3. 检查 `typescript.tsdk` 配置

### Q5: npm install 失败？
**A:**
1. 使用淘宝镜像：`npm config set registry https://registry.npmmirror.com`
2. 清除缓存：`npm cache clean --force`
3. 删除 `node_modules` 和 `package-lock.json`，重新安装

---

## 📝 环境信息记录

完成环境准备后，记录以下信息：

- **Cocos Creator 版本**: 3.8.3
- **Node.js 版本**: v____
- **npm 版本**: v____
- **操作系统**: Windows 10 (10.0.26200)
- **浏览器**: Chrome v____
- **VS Code 版本**: v____
- **TypeScript 版本**: v____

---

## 🔗 相关资源

- [Cocos Creator 官方文档](https://docs.cocos.com/creator/3.8/manual/zh/)
- [TypeScript 官方文档](https://www.typescriptlang.org/docs/)
- [Node.js 官方网站](https://nodejs.org/)
- [VS Code 官方文档](https://code.visualstudio.com/docs)

---

**环境准备完成！** ✅

下一步：阅读 [03_项目结构设计.md](./03_项目结构设计.md)

